{% extends "layout.html" %}

{% block title %}A単adir al Carrito{% endblock %}

{% block content %}
  <h1>A単adir al Carrito</h1>
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  {% if item %}
  <form method="post">
    <fieldset>
      <legend>Detalles del Producto</legend>
      <p><strong>Producto:</strong> {{ item[1] }}</p>
      <p><strong>Variedad:</strong> {{ item[2] or 'N/A' }}</p>
      <p><strong>Lote:</strong> {{ item[3] }}</p>
      <p><strong>Stock Disponible:</strong> {{ "%.2f"|format(item[4]) }} {{ item[5] }}</p>
      <p><strong>Precio de Venta Sugerido:</strong> ${{ "%.2f"|format(item[7]) if item[7] is not none else 'No definido' }}</p>
    </fieldset>
    
    <br>
    <fieldset>
        <legend>Datos para el Carrito</legend>
        <div class="form-group">
          <label for="cantidad">Unidades a A単adir:</label>
          <input type="number" step="0.01" name="cantidad" id="cantidad" required min="0.01" max="{{ item[4] }}" value="1">
        </div>
        <div class="form-group">
          <label for="precio">Precio de Venta por Unidad:</label>
          <input type="number" step="0.01" name="precio" id="precio" required min="0.01" value="{{ item[7] or '0.00' }}">
        </div>
    </fieldset>
    <br>
    <button type="submit">A単adir al Carrito</button>
    <a href="{{ url_for('main.inventario') }}" class="button-secondary">Cancelar</a>
  </form>
  {% endif %}
{% endblock %}
